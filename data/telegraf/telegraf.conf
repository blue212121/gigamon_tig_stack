[global_tags]
[agent]
  interval = "60s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  collection_jitter = "0s"
  flush_interval = "20s"
  flush_jitter = "0s"
  precision = ""
  debug = true
  quiet = false
  logfile = ""
  hostname = ""
  omit_hostname = true

[[outputs.influxdb]]
  urls = ["http://gigamon-monitoring-influx:8086"] # required
  database = "telegraf" # required
  retention_policy = ""
  write_consistency = "any"
  timeout = "5s"

[[inputs.snmp]]
  interval = "15s"
  agents = ["127.0.0.1",]
  version = 2
  community = "public"
  name = "gigamon_env_fans"
[[inputs.snmp.field]]
   name = "hostname"
   oid = "RFC1213-MIB::sysName.0"
   is_tag = true
[[inputs.snmp.field]]
  name = "fans"
  oid = "GIGAMON-SNMP-MIB::fans.0"
[[inputs.snmp.field]]
  name = "fan_id"
  is_tag = true
  oid = "GIGAMON-SNMP-MIB::fans.0"
[[inputs.snmp.field]]
  name = "fan_rpm"
  oid = "GIGAMON-SNMP-MIB::fans.0"

[[inputs.snmp]]
  interval = "15s"
  agents = ["127.0.0.1",]
  version = 2
  community = "public"
  name = "gigamon_env_temp"
[[inputs.snmp.field]]
   name = "hostname"
   oid = "RFC1213-MIB::sysName.0"
   is_tag = true
[[inputs.snmp.field]]
  name = "temperatureSensors"
  oid = "GIGAMON-SNMP-MIB::temperatureSensors.0"
[[inputs.snmp.field]]
  name = "location_id"
  is_tag = true
  oid = "GIGAMON-SNMP-MIB::temperatureSensors.0"
[[inputs.snmp.field]]
  name = "location"
  is_tag = true
  oid = "GIGAMON-SNMP-MIB::temperatureSensors.0"
[[inputs.snmp.field]]
  name = "temp_c"
  oid = "GIGAMON-SNMP-MIB::temperatureSensors.0"

[[inputs.snmp]]
  interval = "15s"
  agents = ["127.0.0.1",]
  version = 2
  community = "public"
  name = "gigamon_env_psu"
[[inputs.snmp.field]]
   name = "hostname"
   oid = "RFC1213-MIB::sysName.0"
   is_tag = true
[[inputs.snmp.field]]
  name = "powerSupply"
  oid = "GIGAMON-SNMP-MIB::powerSupply.0"
[[inputs.snmp.field]]
  name = "psu_id"
  is_tag = true
  oid = "GIGAMON-SNMP-MIB::powerSupply.0"
[[inputs.snmp.field]]
  name = "psu_name"
  is_tag = true
  oid = "GIGAMON-SNMP-MIB::powerSupply.0"
[[inputs.snmp.field]]
  name = "psu_state"
  oid = "GIGAMON-SNMP-MIB::powerSupply.0"

[[inputs.snmp]]
  interval = "15s"
  agents = ["127.0.0.1",]
  version = 2
  community = "public"
  name = "gigamon_stats"
[[inputs.snmp.field]]
   name = "hostname"
   oid = "RFC1213-MIB::sysName.0"
   is_tag = true
[[inputs.snmp.field]]
  name = "uptime"
  oid = "1.3.6.1.2.1.25.1.1.0"
[[inputs.snmp.field]]
  name = "model"
  oid = "1.3.6.1.4.1.26866.2.2.0"
  is_tag = true
[[inputs.snmp.field]]
  name = "serialnum"
  oid = "1.3.6.1.4.1.26866.2.4.0"
  is_tag = true
[[inputs.snmp.field]]
  name = "sw_version"
  oid = "1.3.6.1.4.1.26866.2.6.0"
[[inputs.snmp.field]]
  name = "memTotal"
  oid = "SNMPv2-SMI::enterprises.2021.4.5.0"
[[inputs.snmp.field]]
  name = "memFree"
  oid = "SNMPv2-SMI::enterprises.2021.4.6.0"
[[inputs.snmp.field]]
  name = "load-1"
  oid = "SNMPv2-SMI::enterprises.2021.10.1.5.1"
[[inputs.snmp.field]]
  name = "load-5"
  oid = "SNMPv2-SMI::enterprises.2021.10.1.5.2"
[[inputs.snmp.field]]
  name = "load-15"
  oid = "SNMPv2-SMI::enterprises.2021.10.1.5.3"

[[inputs.snmp.table]]
  name = "gigamon_storage_table"
  inherit_tags = [ "hostname" ]
  [[inputs.snmp.table.field]]
    oid = "HOST-RESOURCES-MIB::hrStorageDescr"
    is_tag = true
  [[inputs.snmp.table.field]]
    oid = "HOST-RESOURCES-MIB::hrStorageUsed"
  [[inputs.snmp.table.field]]
    oid = "HOST-RESOURCES-MIB::hrStorageSize"

[[inputs.snmp.table]]
   name = "gigamon_if_table"
   inherit_tags = [ "hostname" ]
  [[inputs.snmp.table.field]]
     oid = "IF-MIB::ifName"
     is_tag = true
  [[inputs.snmp.table.field]]
     oid = "IF-MIB::ifIndex"
     is_tag = true
  [[inputs.snmp.table.field]]
     oid = "IF-MIB::ifMtu"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifAdminStatus"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifOperStatus"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCInOctets"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCInUcastPkts"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCInMulticastPkts"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCInBroadcastPkts"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifInDiscards"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifInErrors"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCOutOctets"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCOutUcastPkts"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCOutMulticastPkts"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifHCOutBroadcastPkts"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifOutDiscards"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifOutErrors"
  [[inputs.snmp.table.field]]
    oid = "IF-MIB::ifOutQLen"

[[processors.enum]]
  [[processors.enum.mapping]]
    field = "ifAdminStatus"
    dest = "ifAdminStatusStr"
    [processors.enum.mapping.value_mappings]
      1 = "up"
      2 = "down"
      3 = "testing"

  [[processors.enum.mapping]]
    field = "ifOperStatus"
    dest = "ifOperStatusStr"
    [processors.enum.mapping.value_mappings]
      1 = "up"
      2 = "down"
      3 = "testing"
      4 = "unknown"
      5 = "dormant"
      6 = "notPresent"
      7 = "lowerLayerDown"

[[processors.execd]]
  namepass = ["gigamon_env_fans"]
  command = ["python3", "/opt/telegraf/processors/gigamon_parser_env_fans.py"]
  data_format = "influx"

[[processors.execd]]
  namepass = ["gigamon_env_psu"]
  command = ["python3", "/opt/telegraf/processors/gigamon_parser_env_psu.py"]
  data_format = "influx"

[[processors.execd]]
  namepass = ["gigamon_env_temp"]
  command = ["python3", "/opt/telegraf/processors/gigamon_parser_env_temp.py"]
  data_format = "influx"

